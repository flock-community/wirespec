---
title: Spring
slug: /integration/spring
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

This document describes how to integrate Wirespec-generated code with Spring Boot applications. Wirespec simplifies the
creation of type-safe and well-defined APIs, and this integration provides a seamless way to use those APIs within your
Spring applications.

The integration works for both [producers](#restcontroller) (RestController) and [consumers](#webclient)
(WebClient).

## Setup

<Tabs>
    <TabItem value="maven" label="Maven">

        Add both the dependency and plugin to your `pom.xml` file:

        ```xml
        <dependency>
            <groupId>community.flock.wirespec.integration</groupId>
            <artifactId>spring-jvm</artifactId>
            <version>0.13.1</version>
        </dependency>
        ```

        ```xml
        <plugin>
            <groupId>community.flock.wirespec.plugin.maven</groupId>
            <artifactId>wirespec-maven-plugin</artifactId>
            <version>0.13.1</version>
            <executions>
                <execution>
                    <id>java</id>
                    <goals>
                        <goal>compile</goal>
                    </goals>
                    <configuration>
                        <input>${project.basedir}/src/main/wirespec</input>
                        <output>${project.build.directory}/generated-sources</output>
                        <languages>
                            <language>Java</language>
                        </languages>
                        <emitterClass>community.flock.wirespec.integration.spring.java.emit.SpringJavaEmitter</emitterClass>
                    </configuration>
                </execution>
            </executions>
        </plugin>
        ```

        :::info
        Make sure to use the latest version, found here:

        ![Maven Central](https://img.shields.io/maven-central/v/community.flock.wirespec.plugin.maven/wirespec-maven-plugin)
        :::
    </TabItem>
    <TabItem value="gradle" label="Gradle">
        ```json
            tbd
        ```
    </TabItem>
</Tabs>

------------------------------

## Creating and compiling a definition

Now that the setup is complete, we'll add our Wirespec definition in `src/main/wirespec/`, matching the directory we
specified as input in the configuration. The example below contains a simple Todo type and GET endpoint:

[//]: # (Could be the same as in getting-started maybe?)
```wirespec title="src/main/wirespec/todo.ws"
type TodoDto {
    id: Integer,
    task: String
}

endpoint GetTodo GET /api/todos/{id: Integer} -> {
    200 -> TodoDto
    400 -> String
}
```

Now we can compile our definition and generate sources to the specified output directory by running the following
command:

```bash
maven install
```

:::note
It's not necessary to understand the ins and outs of the generated code, so we won't go into detail here.
However, if you're interested to learn more you can look [here](../emitters/java).
:::


## RestController

To enable Spring integration you can simply add the `@EnableWirespecController` annotation to your application's
configuration class:

```java
@SpringBootApplication
// highlight-next-line
@EnableWirespecController
public class TodoApplication {
    public static void main(String[] args) {
        SpringApplication.run(TodoApplication.class, args);
    }
}
```

Next, we'll create a simple controller and implement the Wirespec-generated Handler interface for the endpoint we want
to expose:

```java
@RestController
class TodoController implements GetTodoEndpoint.Handler {

    @Override
    public CompletableFuture<GetTodoEndpoint.Response<?>> getTodo(GetTodoEndpoint.Request request) {
        TodoDto dto = new TodoDto(request.getPath().id(), "Create a Wirespec definition");
        return completedFuture(new GetTodoEndpoint.Response200(dto));
    }
}
```

That's all we need to create a type safe API, see the result for yourself:

```bash
curl http://localhost:8080/api/todos/1 # > {"id":1,"task":"Create a Wirespec definition"}
```

### Accessing parameters

Various request parameters are available on the `GetTodoEndpoint.Request` object. All of them return a `record` matching
your Wirespec definition.

```java
request.getBody();      // Request body
request.getHeaders();   // Request headers
request.getQueries();   // Query parameters
request.getPath();      // Path parameters
```

In the example from the previous sections we defined the `id` path parameter (`/api/todos/{id: Integer}`). Thus,
we can access it like so:

```java
Long id = request.getPath().id();
```



## WebClient

You can enable the webclient like so:
```java
@SpringBootApplication
// highlight-next-line
@EnableWirespecWebClient
public class TodoApplication {
    public static void main(String[] args) {
        SpringApplication.run(TodoApplication.class, args);
    }
}
```

:::note

If you want to use both the Controller *and* WebClient you can use: `@EnableWirespec`

:::

If you are using the WebClient you should add the following to your configuration:

<Tabs>
    <TabItem value="properties" label="Properties">
        ```properties
        wirespec.spring.webclient.base-url=http://localhost:8080
        ```
    </TabItem>
    <TabItem value="yaml" label="YAML">
        ```yaml
        wirespec:
          spring:
            webclient:
              base-url: 'http://localhost:8080'
        ```
    </TabItem>
</Tabs>



Then, we can

```java
@Service
public class TodoService implements GetTodosEndpoint.Handler {

    private final WirespecWebClient wirespecWebClient;

    public TodoWebClient(WirespecWebClient wirespecWebClient) {
        this.wirespecWebClient = wirespecWebClient;
    }

    @Override
    public CompletableFuture<GetTodosEndpoint.Response<?>> getTodos(GetTodosEndpoint.Request request) {
        return wirespecWebClient.send(request);
    }
}
```
